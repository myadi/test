package recruit;

import java.awt.GridBagLayout;
import java.awt.GridBagConstraints;
import java.awt.Component;
import javax.swing.JFrame;
import javax.swing.JTextArea;
import javax.swing.JButton;
import javax.swing.JComboBox;
import javax.swing.JLabel;
import javax.swing.JTextField;
import java.sql.SQLException;
import javax.swing.table.TableRowSorter;
import javax.swing.table.TableModel;
import javax.swing.JScrollPane;

class UploadForm extends JFrame
{
	private GridBagLayout layout=null;
	private GridBagConstraints constraints=null;
	public LoginForm loginForm = null;
	public ActionAdapter a = null;
	public JDBCManager jdbc = null;
	public RegisterForm registerForm = null;
	public RuleForm ruleForm = null;
	public JTextField uploadField = null;
	public JLabel selectedLabel = null;

	public JScrollPane TableScroll = null;
	public ResultSetTableModel tableModel;
	public JTable resultTable = null;

	public 
	public


	public UploadForm(LoginForm loginForm,JDBCManager jdbcObj)throws Exception
	{
		super("Upload your Resume Here");
		this.loginForm = loginForm;
		layout = new GridBagLayout();
		this.jdbc = jdbcObj;
		setLayout(layout);
		registerForm = new RegisterForm(loginForm,jdbc,this);
		ruleForm = new RuleForm(loginForm,registerForm,jdbc,this);
		a = new ActionAdapter(loginForm,registerForm,jdbc,this,ruleForm);
		constraints = new GridBagConstraints();
		JLabel info = new JLabel(" Information for you... ");
		JLabel info1 = new JLabel(" ");
		uploadField = new JTextField();
		JLabel free1 = new JLabel(" ");
		JButton upload = new JButton("Upload");
		JButton browse = new JButton("Browse");
		JLabel free2 = new JLabel(" ");
		JButton logout = new JButton(" Logout ");
		selectedLabel = new JLabel(" ");
		JButton resumeRule = new JButton(" Resume rules & Vacancy List ");

		constraints.fill=GridBagConstraints.BOTH;

		resumeRule.setActionCommand("resumerule");
		browse.setActionCommand("browse");
		upload.setActionCommand("resumeupload");
		logout.setActionCommand("logout");



		addComponent(info,0,0,2,1);
		addComponent(selectedLabel,1,0,2,1);
		addComponent(info1,2,0,2,2);
		addComponent(uploadField,4,0,2,1);
		addComponent(free1,5,0,2,1);
		addComponent(upload,6,0,1,1);
		addComponent(browse,6,1,1,1);
		addComponent(free2,7,0,2,1);
		addComponent(resumeRule,8,0,1,1);
		addComponent(logout,8,1,1,1);


		resumeRule.addActionListener(a);
		browse.addActionListener(a);
		upload.addActionListener(a);
		logout.addActionListener(a);

		this.setDefaultCloseOperation(EXIT_ON_CLOSE);
		this.setSize(300,300);
	}

	private void addComponent(Component component,int row,int col,int width,int height)
	{
		constraints.gridx=col;
		constraints.gridy=row;
		constraints.gridwidth=width;
		constraints.gridheight=height;
		layout.setConstraints(component,constraints);
		add(component);
	}

	public void adminDisp()throws SQLException
	{
		info.remove();
		selectedLabel.remove();
		info1.remove();
		uploadField.remove();
		free1.remove();
		upload.remove();
		browse.remove();
		free2.remove();
		logout.remove();
		resumeRule.remove();

		tableModel = new ResultSetTableModel("jdbc:mysql://localhost/recruit","root","root","select * from selected");

		resultTable = new JTable(tableModel);

		TableScroll = new ScrollPane(resultTable);

		addComponent(TableScroll,0,0,3,3);
		addComponent(logout,3,0,2,1);
	}

	public void checkSelect()throws SQLException
	{
		String selectedPost=" ";
		String change;
		try
		{

		jdbc.resultSet = jdbc.statement.executeQuery("select * from resume");
		int count=0;
		int resume=0;

		while(jdbc.resultSet.next())
		{
			if((jdbc.resultSet.getObject(1).toString()).equals(loginForm.uname.getText()))
			{
				resume++;
				break;
			}
		}
		jdbc.resultSet = jdbc.statement.executeQuery("select * from selected");

		while(jdbc.resultSet.next())
		{
			if((jdbc.resultSet.getObject(1).toString()).equals(loginForm.uname.getText()))
			{
				selectedPost = jdbc.resultSet.getObject(2).toString();
				remove(selectedLabel);
				change = " You have been selected for the "+selectedPost+" post.";
				changeLabel(selectedLabel,change);
				addComponent(selectedLabel,1,0,2,1);
				count++;
				return;
			}

		}


		if(resume==0)
		{
			remove(selectedLabel);
			selectedLabel = new JLabel(" You have not uploaded your resume !");
			addComponent(selectedLabel,1,0,2,1);
			return;
		}

		if(resume==1 && count==0)
		{
			remove(selectedLabel);
			selectedLabel = new JLabel("Sorry, you have not been selected!");
			addComponent(selectedLabel,1,0,2,1);
		}
		}

		catch(SQLException e)
		{
			e.printStackTrace();
		}
	}

	public void changeLabel(JLabel lab,String change)
	{
		lab.setText(change);
	}
}
